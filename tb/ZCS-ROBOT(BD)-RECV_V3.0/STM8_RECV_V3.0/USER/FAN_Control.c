/******************************************************************************/
/*					                                      */
/*	Project Name :	接收机		                                      */
/*	Version      :	1.0			                              */
/*	MCU          :	ST 8-bit STM8S104K4T6C	                              */
/*	Clock        :	16MHz			                              */
/*	Author	     :	mengzhuozhuo   		                              */
/*      Date	     :	2016/04/26	                                      */
/*	Corporation  :	中惠创智（深圳）无线供电技术有限公司                   */
/*						                              */
/******************************************************************************/
/*******************************************************************************
-----------------------------     File start    --------------------------------
*******************************************************************************/


/*******************************************************************************
-----------------------------    Include files   -------------------------------
*******************************************************************************/
#include "type_def.h"
#include "FAN_Control.h"

//******************************************************************************
/*风扇控制*/
//******************************************************************************
void  FAN_Control(void)
{
    if (MacStatus == C_MSWork)
    {
        if(myStatus == 6)
        {
            PD_ODR_ODR3 = 0;
        }
        else
        {
            PD_ODR_ODR3 = 1;
        }
    }
    else 
    {
        PD_ODR_ODR3 = 0;
    }
}
//******************************************************************************


//******************************************************************************
/*打开风扇*/
//******************************************************************************
void  Fan_Open(void)
{
    if(C_Fan_PWM ==1)
    {
        TIM2_CCR2H = 0x01;//占空比50%
        TIM2_CCR2L = 0x90;
    }
    else
    {
        FAN_SPEED_ADJ =1; 
    }
    Flag_Fan_Open =1;
}
//******************************************************************************


//******************************************************************************
/*关闭风扇*/
//******************************************************************************
void  Fan_Close(void)
{
    if(C_Fan_PWM ==1)
    {
        TIM2_CCR2H = 0x00;
        TIM2_CCR2L = 0x00;
    }
    else
    {
        FAN_SPEED_ADJ =0;      
    }
    Flag_Fan_Open =0;
}
//******************************************************************************


//******************************************************************************
/*根据温度控制风扇*/
//******************************************************************************
void  Fan_Adjust_Temp(void)
{
    if(ACTemp_DD >= C_Maximum_Temp1)
    {
        Fan_Open();
    }
    else if(ACTemp_DD <= C_Minimum_Temp1)
    {
        Fan_Close();
    }     
}
//******************************************************************************


//******************************************************************************
/*根据时间控制风扇*/
//******************************************************************************
void  Fan_Adjust_Time(void)
{
      if(Flag_Fan_First ==1)
      {
           if(CNT_Fan_Open < C_Fan_Close)
           {
                CNT_Fan_Open++;
           }
           else
           {
                Flag_Fan_First =0;
           }           
      }
      else
      {
          Fan_Close();
      }
}
/*******************************************************************************
-----------------------------    End of file    --------------------------------
*******************************************************************************/